/* gz.c - implementations of the Gamma and Zeta functions
 *
 * NOTE: DO NOT EDIT THIS FILE, it was generated via the `gen_gz.py` script, available here: https://github.com/ChemicalDevelopment/kscript/blob/master/modules/m/tools/gen_gz.py
 *
 * Generation Arguments:
 * $ ./tools/gen_gz.py
 *
 *
 * To embed this in your own, compile it like so:
 * $ cc -std=c99 -Ofast -fno-math-errno gz.c -o gz.o
 * Then,
 * $ cc other_objs.o... gz.o -lm -o total.o
 *
 * The flags `-Ofast` and `-fno-math-errno` are not required; they are just mainly included to generate more efficient code
 *
 *
 * You can embed all this data & use these methods in any non-commercial project for free; for commercial projects,
 *   contact the @author below.
 *
 * @author:    Cade Brown <cade@kscript.org>
 */
#include <ks/impl.h>
#include <ks/m.h>


#define KSF(_x) _x


/* -- GAMMA -- */

/* NOTE: correct to 14.188319365090821 digits */

ks_cfloat ksm_gamma(ks_cfloat x) {
    if (x <= 0) {
        if (floor(x) == x) {
            /* Pole at non-positive integer */
            return KS_CFLOAT_NAN;
        } 

        /* Reflect: Gamma(x) = pi / (sin(pi * x) * Gamma(1 - x)) */
        return KS_M_PI / (sin(KS_M_PI * x) * ksm_gamma(1 - x));
    } else {
        x -= 1.0;

        /* Generated Table */
        static const ks_cfloat g = 4.7421875;
        static const int a_n = 15;
        static const ks_cfloat a[] = {
            KSF(    0.99999999999999709182046422698042381484509186),
            KSF(   57.15623566586292351657939348597744427325444289),
            KSF(  -59.59796035547549124814226613160283600191010086),
            KSF(   14.13609797474174717386341954087672601565916414),
            KSF(   -0.49191381609762019978284002853030784416348279),
            KSF(    0.00003399464998481188869891934155234155285737),
            KSF(    0.00004652362892704857566523022496582288935897),
            KSF(   -0.00009837447530487956467653837063470730301913),
            KSF(    0.00015808870322491248883607241344366395885874),
            KSF(   -0.00021026444172410488319269928300571190544166),
            KSF(    0.00021743961811521264319614464960383469237637),
            KSF(   -0.00016431810653676389021706956228018413242085),
            KSF(    0.00008441822398385274329281181534545498133891),
            KSF(   -0.00002619083840158140866966503624795490184143),
            KSF(    0.00000368991826595316227036759674456787362014),
        };

        /* Sum over table */
        ks_cfloat sum = a[0];
        int i;
        for (i = 1; i < a_n; ++i) {
            sum += a[i] / (x + i);
        }

        /* Recombine */
        ks_cfloat tmp = x + g + 0.5;
        return KS_M_SQRT_2PI * pow(tmp, x + 0.5) * exp(-tmp) * sum;
    }
}


ks_ccomplex ksm_cgamma(ks_ccomplex x) {
    if (x.im == 0.0) return KS_CC_MAKE(ksm_gamma(x.re), 0);

    if (x.re < 0) {
        /* Reflect: Gamma(x) = pi / (sin(pi * x) * Gamma(1 - x)) */
        ks_ccomplex t0 = ksm_csin(KS_CC_MAKE(KS_M_PI * x.re, KS_M_PI * x.im)), t1 = KS_CC_MAKE(1 - x.re, -x.im) /* 1-x */;
        t0 = ksm_cmul(t0, ksm_cgamma(t1));
        return ksm_cdiv(KS_CC_MAKE(KS_M_PI, 0), t0);
    } else {
        ks_cfloat xrs = x.re - 1.0;

        /* Generated Table */
        static const ks_cfloat g = 4.7421875;
        static const int a_n = 15;
        static const ks_cfloat a[] = {
            KSF(    0.99999999999999709182046422698042381484509186),
            KSF(   57.15623566586292351657939348597744427325444289),
            KSF(  -59.59796035547549124814226613160283600191010086),
            KSF(   14.13609797474174717386341954087672601565916414),
            KSF(   -0.49191381609762019978284002853030784416348279),
            KSF(    0.00003399464998481188869891934155234155285737),
            KSF(    0.00004652362892704857566523022496582288935897),
            KSF(   -0.00009837447530487956467653837063470730301913),
            KSF(    0.00015808870322491248883607241344366395885874),
            KSF(   -0.00021026444172410488319269928300571190544166),
            KSF(    0.00021743961811521264319614464960383469237637),
            KSF(   -0.00016431810653676389021706956228018413242085),
            KSF(    0.00008441822398385274329281181534545498133891),
            KSF(   -0.00002619083840158140866966503624795490184143),
            KSF(    0.00000368991826595316227036759674456787362014),
        };

        /* Sum over table */
        ks_ccomplex tmp0, tmp1;
        ks_cfloat sumr = a[0], sumi = 0.0;
        long double sum_re = a[0], sum_im = 0.0;
        int i;
        for (i = 1; i < a_n; ++i) {
            /* sum += a[i] / (x + i) */
            tmp0 = KS_CC_MAKE(xrs + i, x.im);
            tmp1 = ksm_cdiv(KS_CC_MAKE(a[i], 0), tmp0);
            sumr += tmp1.re;
            sumi += tmp1.im;
        }

        /* Recombine */
        ks_ccomplex t0 = KS_CC_MAKE(xrs + g + 0.5, x.im), t1 = KS_CC_MAKE(xrs + 0.5, x.im);
        ks_ccomplex t2 = ksm_cpow(t0, t1), t3 = ksm_cexp(KS_CC_NEG(t0));

        t0 = ksm_cmul(ksm_cmul(KS_CC_MAKE(sumr, sumi), t2), t3);

        return ksm_cmul(KS_CC_MAKE(KS_M_SQRT_2PI, 0), t0);
    }
}




/* -- ZETA -- */

ks_cfloat ksm_zeta(ks_cfloat x) {
    if (x < 0) {
        if (x == floor(x)) {
            /* Zeta(-2k) == 0 */
            if ((ks_cint)x % 2 == 0) return 0.0;
        } 

        /* Reflect: Zeta(x) = 2 * (2*pi)^(x-1) * sin(x*pi/2) * Gamma(x-1) * Zeta(1-x) */
        return 2 * pow(2 * KS_M_PI, x - 1) * sin(x * KS_M_PI / 2) * ksm_gamma(1 - x) * ksm_zeta(1 - x);

    } else {
        /* x >= 0, summation will converge */

        /* Computed table (with sign baked in) 
         * TODO: don't bake it in and process two at a time, then subtract?
         */
        static const int n = 24;
        static const ks_cfloat d[] = {
            KSF(    0.99999999999999999915316831449165727118563471),
            KSF(   -0.99999999999999902360306660888083367703682290),
            KSF(    0.99999999999981204316690636680631146518122476),
            KSF(   -0.99999999998555166856908523792275077432760672),
            KSF(    0.99999999940800649735732951813854279475607626),
            KSF(   -0.99999998503354890275363160350936641430909587),
            KSF(    0.99999974502366603527976642288281533472466576),
            KSF(   -0.99999689655472650921631153193034098361274796),
            KSF(    0.99997187750254100529229940639777459967973657),
            KSF(   -0.99980442972843671759172152048046755950062770),
            KSF(    0.99893193869494595536239464122713087646211307),
            KSF(   -0.99533621807207493526577477521337969787914367),
            KSF(    0.98348076239521758639648463726948994240630979),
            KSF(   -0.95196348945735681894089485516634917708776065),
            KSF(    0.88409295990333918743600045666910953960284266),
            KSF(   -0.76551456344114746342744932366243798905448018),
            KSF(    0.59768788135151320888308864751186656065740265),
            KSF(   -0.40622785187314257981287325939000254252169923),
            KSF(    0.23178649168173822888223257243452643710916944),
            KSF(   -0.10672469148761619066168789786047244403958905),
            KSF(    0.03778036573957455420677224392862216580892294),
            KSF(   -0.00959406764049133001149894522477629131740788),
            KSF(    0.00154935253821599118198119612325579859784227),
            KSF(   -0.00011918096447815316784470739409659989214171),
        };
        ks_cfloat sum = 0.0;
        int i;
        for (i = 0; i < n; ++i) {
            sum += d[i] * pow(i + 1, -x);
        }

        // divide by the normalization factor in Proposition 1 (without d0, since everything has been normalized by that)
        /* Divide by normalization in Prop#1 (without d0, since everything has been normalized by that) */
        sum /= 1 - pow(2, 1 - x);

        return sum;
    }
}




ks_ccomplex ksm_czeta(ks_ccomplex x) {
    if (x.im == 0.0) return KS_CC_MAKE(ksm_zeta(x.re), 0);

    if (x.re < 0) {
        /* Reflect: Zeta(x) = 2 * (2*pi)^(x-1) * sin(x*pi/2) * Gamma(x-1) * Zeta(1-x) */
        ks_ccomplex t0 = ksm_cpow(KS_CC_MAKE(2 * KS_M_PI, 0), KS_CC_MAKE(x.re-1, x.im)) /* (2*pi)^(x-1) */;
        ks_ccomplex t1 = ksm_csin(KS_CC_MAKE((KS_M_PI / 2.0) * x.re, (KS_M_PI / 2.0) * x.im)) /* sin(x*pi/2) */;
        ks_ccomplex t2 = ksm_cgamma(KS_CC_MAKE(x.re-1, x.im)), t3 = ksm_czeta(KS_CC_MAKE(x.re-1, x.im)) /* {Gamma,Zeta}(1-x) */;

        return ksm_cmul(KS_CC_MAKE(2, 0), ksm_cmul(t0, ksm_cmul(t1, ksm_cmul(t2, t3))));

    } else {
        /* re(x) >= 0, will converge */

        /* Generated Tables */


        /* NOTE: this table is useful for abs(imag(x)) <= 1 */
        static const int n_0 = 28;
        static const ks_cfloat d_0[] = {
            KSF(    0.99999999999999999999926617649791646219655661),
            KSF(   -0.99999999999999999884863092523092918639732831),
            KSF(    0.99999999999999969853283034454725020279874115),
            KSF(   -0.99999999999996846568956995344463590854567626),
            KSF(    0.99999999999823950472336973169277319096529842),
            KSF(   -0.99999999993922430374373549589585909755506829),
            KSF(    0.99999999858187468121214807256683494911977531),
            KSF(   -0.99999997626764352398956801432265773967803573),
            KSF(    0.99999970291831184801296230083148692401672589),
            KSF(   -0.99999713021871960352726146797340865896910381),
            KSF(    0.99997809224173699433307530482362949761670048),
            KSF(   -0.99986534785856725676750529967688537324402619),
            KSF(    0.99932368462638221324596244886317990614922143),
            KSF(   -0.99719036481962265722265522104304760497583652),
            KSF(    0.99024860989286537174998884480293456147513962),
            KSF(   -0.97148193450466636550664250351931860939049695),
            KSF(    0.92918124280304037965974490360987781416745159),
            KSF(   -0.84955641136468558277146706848622455257113091),
            KSF(    0.72443167624727090194703047043476942720548413),
            KSF(   -0.56068380098692736516398399787809984635712702),
            KSF(    0.38308033628147783680698743918201976251390894),
            KSF(   -0.22466052107382947701816820912558595950393043),
            KSF(    0.10978103562726840427490183299586757804003482),
            KSF(   -0.04318423246984169543822567292066851632183446),
            KSF(    0.01307397572313281112377102607815830224711621),
            KSF(   -0.00284877832996473285861744804837524179398741),
            KSF(    0.00039658167006469598959871666566708702468502),
            KSF(   -0.00002643877800431306597324777771113913497900),
        };


        /* NOTE: this table is useful for abs(imag(x)) <= 2 */
        static const int n_1 = 28;
        static const ks_cfloat d_1[] = {
            KSF(    0.99999999999999999999926617649791646219655661),
            KSF(   -0.99999999999999999884863092523092918639732831),
            KSF(    0.99999999999999969853283034454725020279874115),
            KSF(   -0.99999999999996846568956995344463590854567626),
            KSF(    0.99999999999823950472336973169277319096529842),
            KSF(   -0.99999999993922430374373549589585909755506829),
            KSF(    0.99999999858187468121214807256683494911977531),
            KSF(   -0.99999997626764352398956801432265773967803573),
            KSF(    0.99999970291831184801296230083148692401672589),
            KSF(   -0.99999713021871960352726146797340865896910381),
            KSF(    0.99997809224173699433307530482362949761670048),
            KSF(   -0.99986534785856725676750529967688537324402619),
            KSF(    0.99932368462638221324596244886317990614922143),
            KSF(   -0.99719036481962265722265522104304760497583652),
            KSF(    0.99024860989286537174998884480293456147513962),
            KSF(   -0.97148193450466636550664250351931860939049695),
            KSF(    0.92918124280304037965974490360987781416745159),
            KSF(   -0.84955641136468558277146706848622455257113091),
            KSF(    0.72443167624727090194703047043476942720548413),
            KSF(   -0.56068380098692736516398399787809984635712702),
            KSF(    0.38308033628147783680698743918201976251390894),
            KSF(   -0.22466052107382947701816820912558595950393043),
            KSF(    0.10978103562726840427490183299586757804003482),
            KSF(   -0.04318423246984169543822567292066851632183446),
            KSF(    0.01307397572313281112377102607815830224711621),
            KSF(   -0.00284877832996473285861744804837524179398741),
            KSF(    0.00039658167006469598959871666566708702468502),
            KSF(   -0.00002643877800431306597324777771113913497900),
        };


        /* NOTE: this table is useful for abs(imag(x)) <= 4 */
        static const int n_2 = 28;
        static const ks_cfloat d_2[] = {
            KSF(    0.99999999999999999999926617649791646219655661),
            KSF(   -0.99999999999999999884863092523092918639732831),
            KSF(    0.99999999999999969853283034454725020279874115),
            KSF(   -0.99999999999996846568956995344463590854567626),
            KSF(    0.99999999999823950472336973169277319096529842),
            KSF(   -0.99999999993922430374373549589585909755506829),
            KSF(    0.99999999858187468121214807256683494911977531),
            KSF(   -0.99999997626764352398956801432265773967803573),
            KSF(    0.99999970291831184801296230083148692401672589),
            KSF(   -0.99999713021871960352726146797340865896910381),
            KSF(    0.99997809224173699433307530482362949761670048),
            KSF(   -0.99986534785856725676750529967688537324402619),
            KSF(    0.99932368462638221324596244886317990614922143),
            KSF(   -0.99719036481962265722265522104304760497583652),
            KSF(    0.99024860989286537174998884480293456147513962),
            KSF(   -0.97148193450466636550664250351931860939049695),
            KSF(    0.92918124280304037965974490360987781416745159),
            KSF(   -0.84955641136468558277146706848622455257113091),
            KSF(    0.72443167624727090194703047043476942720548413),
            KSF(   -0.56068380098692736516398399787809984635712702),
            KSF(    0.38308033628147783680698743918201976251390894),
            KSF(   -0.22466052107382947701816820912558595950393043),
            KSF(    0.10978103562726840427490183299586757804003482),
            KSF(   -0.04318423246984169543822567292066851632183446),
            KSF(    0.01307397572313281112377102607815830224711621),
            KSF(   -0.00284877832996473285861744804837524179398741),
            KSF(    0.00039658167006469598959871666566708702468502),
            KSF(   -0.00002643877800431306597324777771113913497900),
        };


        /* NOTE: this table is useful for abs(imag(x)) <= 8 */
        static const int n_3 = 32;
        static const ks_cfloat d_3[] = {
            KSF(    0.99999999999999999999999936410394010364069854),
            KSF(   -0.99999999999999999999869704897327235979130703),
            KSF(    0.99999999999999999955460758941557170714880244),
            KSF(   -0.99999999999999993915844108956828294776817835),
            KSF(    0.99999999999999556043636985063984789267293190),
            KSF(   -0.99999999999979939368757834664595742440589070),
            KSF(    0.99999999999386089120143554392181870323091616),
            KSF(   -0.99999999986491055150233468476909218628861191),
            KSF(    0.99999999776946753139194572353728628597616788),
            KSF(   -0.99999997147371198490863326886364361538863497),
            KSF(    0.99999971045373850771112121878738005366186089),
            KSF(   -0.99999762229395069013102481817727155984766830),
            KSF(    0.99998395846577388379169837070677902423740805),
            KSF(   -0.99990996358087794792334591671272713908646026),
            KSF(    0.99957522481587252375698957721582575387979167),
            KSF(   -0.99830090896564497796506751237244944605854296),
            KSF(    0.99419535104495219938544763410689432529572957),
            KSF(   -0.98295446518722651685729053425681827272588758),
            KSF(    0.95672573151919992429159063460664081672958959),
            KSF(   -0.90449212250748267024894503075137988017935178),
            KSF(    0.81569498718756333837644750419743628804394751),
            KSF(   -0.68698555062628653677728732633527414752712459),
            KSF(    0.52834368695773606038762478152842313712266843),
            KSF(   -0.36280435095577034589406386520823077843975766),
            KSF(    0.21751716776255575604599178439529599555316044),
            KSF(   -0.11124997091266165604283049100069226864182076),
            KSF(    0.04729731398489733341649360402565925651870683),
            KSF(   -0.01619245778522998991689159610488848332675205),
            KSF(    0.00427566222821457909561550216121656372723691),
            KSF(   -0.00081524972526999519107071989082181393427425),
            KSF(    0.00009970680093230157013095135355374702793282),
            KSF(   -0.00000586510593719421000770302079727923693722),
        };


        /* NOTE: this table is useful for abs(imag(x)) <= 16 */
        static const int n_4 = 40;
        static const ks_cfloat d_4[] = {
            KSF(    0.99999999999999999999999999999952249802893360),
            KSF(   -0.99999999999999999999999999847151619061645828),
            KSF(    0.99999999999999999999999918404415433976711087),
            KSF(   -0.99999999999999999999982587390155247902598209),
            KSF(    0.99999999999999999998013041412444101908770422),
            KSF(   -0.99999999999999999859357004581579423943294215),
            KSF(    0.99999999999999993241682519472128884681929789),
            KSF(   -0.99999999999999765768212306039587271390194357),
            KSF(    0.99999999999993885579007288808386567798833457),
            KSF(   -0.99999999999875820603596746754474401572293016),
            KSF(    0.99999999997988023786242921702973554223714809),
            KSF(   -0.99999999973471182002427011943222289956465373),
            KSF(    0.99999999710714595058486935605018522918335542),
            KSF(   -0.99999997356415576040783851614712770256692264),
            KSF(    0.99999979531008717763889072830969214389964587),
            KSF(   -0.99999864464934101576485535302803915829570753),
            KSF(    0.99999226497786531989066728443016474214483974),
            KSF(   -0.99996169714020637067530627125532261983907745),
            KSF(    0.99983447671109245822661329261336064414747632),
            KSF(   -0.99937264664694067363334944980498658729830693),
            KSF(    0.99790544805852000411782662611376746823133034),
            KSF(   -0.99381569589567493229755394683510790288784157),
            KSF(    0.98379450613513066540601898851805412649650228),
            KSF(   -0.96218359256456563767470881753866859132213581),
            KSF(    0.92114584711407779246152939711504818676230162),
            KSF(   -0.85253743676093566430104657831702811448594208),
            KSF(    0.75164271565337371112386596243758683172658982),
            KSF(   -0.62134680747253898752398491551570878103526699),
            KSF(    0.47396013730954282615321038062096101200651090),
            KSF(   -0.32844589308328164323905185615137337797449038),
            KSF(    0.20364893108584408636690912160626940709279141),
            KSF(   -0.11125562236219914738171619280502902674674247),
            KSF(    0.05268486415345994498931710401138557134880073),
            KSF(   -0.02122868072387133838976290807186237292529077),
            KSF(    0.00711620510269506273359768056958286950613923),
            KSF(   -0.00192702152025012162275928635756456762779283),
            KSF(    0.00040437375544820228272454627187844618461607),
            KSF(   -0.00006162298129064324579706683015421003598539),
            KSF(    0.00000606127684825999138987542591680754452315),
            KSF(   -0.00000028863223086952339951787742460988307253),
        };


        /* NOTE: this table is useful for abs(imag(x)) <= 32 */
        static const int n_5 = 56;
        static const ks_cfloat d_5[] = {
            KSF(    0.99999999999999999999999999999999999999999973),
            KSF(   -0.99999999999999999999999999999999999999831100),
            KSF(    0.99999999999999999999999999999999999823359194),
            KSF(   -0.99999999999999999999999999999999926128690977),
            KSF(    0.99999999999999999999999999999983465898154359),
            KSF(   -0.99999999999999999999999999997700980597076557),
            KSF(    0.99999999999999999999999999782524866304560153),
            KSF(   -0.99999999999999999999999985122174222199046902),
            KSF(    0.99999999999999999999999230847133582970390137),
            KSF(   -0.99999999999999999999968941527854580219624376),
            KSF(    0.99999999999999999998994900786829807550262264),
            KSF(   -0.99999999999999999973391544165607211669886744),
            KSF(    0.99999999999999999414013861462809192979073756),
            KSF(   -0.99999999999999989114579851328829673453458629),
            KSF(    0.99999999999999827429814200177944835186262424),
            KSF(   -0.99999999999997641897809536345294607574506819),
            KSF(    0.99999999999971988334641889503178427825230352),
            KSF(   -0.99999999999708593461476745455782357672231323),
            KSF(    0.99999999997328005512584157827412161717982961),
            KSF(   -0.99999999978283301921443456800450594083996066),
            KSF(    0.99999999842772910984480776416300978226781619),
            KSF(   -0.99999998981550077991379978434806555496610359),
            KSF(    0.99999994074582773728363803889082519010750856),
            KSF(   -0.99999968928153226084849031144618471164375202),
            KSF(    0.99999852692795370222006810320473484044691989),
            KSF(   -0.99999366876442535921800956753434844001607868),
            KSF(    0.99997526929441077508804126728044157503592443),
            KSF(   -0.99991200906207551728269952217266954449619072),
            KSF(    0.99971425921891841918210526181629645682198416),
            KSF(   -0.99915151556361836505918003452266124543694627),
            KSF(    0.99769219727106059758786546204933603625201751),
            KSF(   -0.99424107542848083231461386601511586942229704),
            KSF(    0.98679445835743818403155610671508723563792995),
            KSF(   -0.97213035089446189202799621147810777218563784),
            KSF(    0.94577615600709361307164229966941860476962207),
            KSF(   -0.90256182401786860906867687906386618118062727),
            KSF(    0.83794321022177394345860886750110351961680171),
            KSF(   -0.74990304037000483222386237266549944906705049),
            KSF(    0.64073322975381113429277671906935040158535898),
            KSF(   -0.51771270390459386030050437415780582060698932),
            KSF(    0.39196703982453949479574498363113208751833932),
            KSF(   -0.27564946076584421902621145526680155212287626),
            KSF(    0.17855130957226898882272821730346194856556201),
            KSF(   -0.10565464011257803624315010376819413128477670),
            KSF(    0.05663791409657894743964068259792784035459347),
            KSF(   -0.02726459513568061707049646017379822781216158),
            KSF(    0.01167273781816602316695167703323062172776510),
            KSF(   -0.00439582431376662450229110562925946720656427),
            KSF(    0.00143718448105686899258042594001330043412867),
            KSF(   -0.00040138042432869033317403608036557867748385),
            KSF(    0.00009377800748214030704729000083383100429841),
            KSF(   -0.00001781794647868240892397006040199581884086),
            KSF(    0.00000264295296230825825332922092065458500225),
            KSF(   -0.00000028694318725933351308956497961616163539),
            KSF(    0.00000002027126048847910323897048577069107777),
            KSF(   -0.00000000069900898236134838755070640588589923),
        };


        /* NOTE: this table is useful for abs(imag(x)) <= 64 */
        static const int n_6 = 84;
        static const ks_cfloat d_6[] = {
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -0.99999999999999999999999999999999999999999998),
            KSF(    0.99999999999999999999999999999999999999999812),
            KSF(   -0.99999999999999999999999999999999999999982777),
            KSF(    0.99999999999999999999999999999999999998732037),
            KSF(   -0.99999999999999999999999999999999999923406103),
            KSF(    0.99999999999999999999999999999999996138004976),
            KSF(   -0.99999999999999999999999999999999835124512139),
            KSF(    0.99999999999999999999999999999993967929140860),
            KSF(   -0.99999999999999999999999999999808915238350192),
            KSF(    0.99999999999999999999999999994711758259353996),
            KSF(   -0.99999999999999999999999999871144316344294696),
            KSF(    0.99999999999999999999999997216601841934116025),
            KSF(   -0.99999999999999999999999946376260625065487830),
            KSF(    0.99999999999999999999999073617069735487370473),
            KSF(   -0.99999999999999999999985579807140441568789463),
            KSF(    0.99999999999999999999796866165106024504490551),
            KSF(   -0.99999999999999999997400294077279572433819155),
            KSF(    0.99999999999999999969665496174366003878371995),
            KSF(   -0.99999999999999999676242654687215107161151427),
            KSF(    0.99999999999999996830085349100688083347508175),
            KSF(   -0.99999999999999971451352142053808402102163736),
            KSF(    0.99999999999999762917267725189382761531651705),
            KSF(   -0.99999999999998180429938671863699013608782424),
            KSF(    0.99999999999987067256209783254518795144790809),
            KSF(   -0.99999999999914711151000858581738864034973377),
            KSF(    0.99999999999477200772778243620832435350114992),
            KSF(   -0.99999999997016536342532263719492036443759955),
            KSF(    0.99999999984125592834825712296052036203004463),
            KSF(   -0.99999999921138788118081485879243753453143260),
            KSF(    0.99999999633755330916723438745903302189887646),
            KSF(   -0.99999998408039882208969013356757801059674882),
            KSF(    0.99999993516360052874934334628287299356152085),
            KSF(   -0.99999975233238373073001189757040908706688255),
            KSF(    0.99999911184454513766861976553022698425180473),
            KSF(   -0.99999700735695262713386790018169729261731836),
            KSF(    0.99999051761466361730926016854179649368710366),
            KSF(   -0.99997172488350441621934273169454340042379522),
            KSF(    0.99992059962167267114348061379295152131091797),
            KSF(   -0.99978988234797552518172578550024219743679487),
            KSF(    0.99947567374598300662769399326869866737912009),
            KSF(   -0.99876545160283816944768161458014911877014574),
            KSF(    0.99725560654677543882859389549971067047729545),
            KSF(   -0.99423655175762749188901685318107254454099225),
            KSF(    0.98855828911379569673599417358783598848705632),
            KSF(   -0.97851357367784242214186824533049343388339408),
            KSF(    0.96180363817852508147090819664249452396580063),
            KSF(   -0.93566827814509145466047939811952192523754664),
            KSF(    0.89724776098967691223614879676020568197036261),
            KSF(   -0.84418322687010520059754039321472803488908090),
            KSF(    0.77535982370537110483974423018647179441783041),
            KSF(   -0.69158781923222791112120333309882563306173603),
            KSF(    0.59595962701955740482840417411451710644025138),
            KSF(   -0.49366807678076861466962842589778030206924709),
            KSF(    0.39123326106545491023892161921015170945682682),
            KSF(   -0.29530730980895195331912139595789743061425144),
            KSF(    0.21140669416760987062110572731214132782380065),
            KSF(   -0.14296509989713602436687681869241596854432688),
            KSF(    0.09097710739887008849413945626399761615856519),
            KSF(   -0.05427240667260481236216507515770821292377577),
            KSF(    0.03023562486458792669720567823152146747901778),
            KSF(   -0.01566951311918436002783290936142737866724657),
            KSF(    0.00752328025416236533496147195630068455399675),
            KSF(   -0.00333167159495714136520301733464234961621540),
            KSF(    0.00135433513598982604956156751825881854073581),
            KSF(   -0.00050264451456668514045698939337161586393349),
            KSF(    0.00016928076123186988563070250105465522023562),
            KSF(   -0.00005136730894225738548241547934141000058471),
            KSF(    0.00001392724052818112371442656842051011194027),
            KSF(   -0.00000334016077977119197511158331894021054282),
            KSF(    0.00000069984862920050317780246103236883917654),
            KSF(   -0.00000012611133139378360212031579396609656575),
            KSF(    0.00000001914657793999154888726737648389790200),
            KSF(   -0.00000000238132108969954280123608376557215804),
            KSF(    0.00000000023294304992155774461414924270494400),
            KSF(   -0.00000000001680379770250120030865287785548577),
            KSF(    0.00000000000079468056222991653920492026151871),
            KSF(   -0.00000000000001848094330767247765592837817485),
        };


        /* NOTE: this table is useful for abs(imag(x)) <= 128 */
        static const int n_7 = 144;
        static const ks_cfloat d_7[] = {
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -0.99999999999999999999999999999999999999999993),
            KSF(    0.99999999999999999999999999999999999999999855),
            KSF(   -0.99999999999999999999999999999999999999997330),
            KSF(    0.99999999999999999999999999999999999999953770),
            KSF(   -0.99999999999999999999999999999999999999247435),
            KSF(    0.99999999999999999999999999999999999988463944),
            KSF(   -0.99999999999999999999999999999999999833239166),
            KSF(    0.99999999999999999999999999999999997723598271),
            KSF(   -0.99999999999999999999999999999999970617909193),
            KSF(    0.99999999999999999999999999999999640974987909),
            KSF(   -0.99999999999999999999999999999995842090951962),
            KSF(    0.99999999999999999999999999999954311548608313),
            KSF(   -0.99999999999999999999999999999523166569487266),
            KSF(    0.99999999999999999999999999995268707206551424),
            KSF(   -0.99999999999999999999999999955326716683108809),
            KSF(    0.99999999999999999999999999598253336518687039),
            KSF(   -0.99999999999999999999999996556063293662803555),
            KSF(    0.99999999999999999999999971835600607701859118),
            KSF(   -0.99999999999999999999999780105085889573465320),
            KSF(    0.99999999999999999999998359749939482751606621),
            KSF(   -0.99999999999999999999988302830331688224945688),
            KSF(    0.99999999999999999999920198932987642765275771),
            KSF(   -0.99999999999999999999478851412086356968773369),
            KSF(    0.99999999999999999996740174704852936936271271),
            KSF(   -0.99999999999999999980458867307722146284332191),
            KSF(    0.99999999999999999887679512317186936105280376),
            KSF(   -0.99999999999999999380641273586114214741730635),
            KSF(    0.99999999999999996721997291370141597505030689),
            KSF(   -0.99999999999999983340579571811724588484039392),
            KSF(    0.99999999999999918663727260612709044882581455),
            KSF(   -0.99999999999999618351427787721141410373820254),
            KSF(    0.99999999999998278248155946323285837028272961),
            KSF(   -0.99999999999992529162576785715647400214816487),
            KSF(    0.99999999999968809940651149419320217623471823),
            KSF(   -0.99999999999874668532698236367230934780305406),
            KSF(    0.99999999999515110636165609163195276898389903),
            KSF(   -0.99999999998193248141450216142859943915385544),
            KSF(    0.99999999993514315690112309737328755467701048),
            KSF(   -0.99999999977564467037630272710793579699353943),
            KSF(    0.99999999925190606354505803749046522577186421),
            KSF(   -0.99999999759494380647192030803641189126653029),
            KSF(    0.99999999254326885993678109595766925625075411),
            KSF(   -0.99999997769893276763361906926922231061724420),
            KSF(    0.99999993564953284593573023948637581468499797),
            KSF(   -0.99999982080857663920467278221814538463111388),
            KSF(    0.99999951837537879328048155935648103667986911),
            KSF(   -0.99999875029106680363174194573955570854972367),
            KSF(    0.99999686889745098382547437604132356072125987),
            KSF(   -0.99999242381492917590780406543606718242848369),
            KSF(    0.99998229308047106179355388426889875422820212),
            KSF(   -0.99996001960310099447634038879883869952699261),
            KSF(    0.99991277636776945112432762532613164051312987),
            KSF(   -0.99981610280610963579779928041491275611703716),
            KSF(    0.99962525039545901378091333915662249489195936),
            KSF(   -0.99926174730075654121690363829850752467837573),
            KSF(    0.99859381716169423918884229350128307716637678),
            KSF(   -0.99740981768589979243389732777209908543027073),
            KSF(    0.99538517858229128848294143637519445956152939),
            KSF(   -0.99204561008942241482956507110780603839899686),
            KSF(    0.98673256598810464749647778111381688666741965),
            KSF(   -0.97858058671978441095699736142296060334762005),
            KSF(    0.96651918237351112204048172501887233906297952),
            KSF(   -0.94931284071266069465501472240905296338136270),
            KSF(    0.92564996078835768910169356408104217786950670),
            KSF(   -0.89428396010896968953783705791525790077776774),
            KSF(    0.85421772603869123590647541484070514455816097),
            KSF(   -0.80490807201490962318992329388361441739082269),
            KSF(    0.74645381234694789349443549963128928221296390),
            KSF(   -0.67972430215633619529721762283111665186892205),
            KSF(    0.60638890578102575109756159440801235912398762),
            KSF(   -0.52882338531549864120863916485769979453016308),
            KSF(    0.44989430600473576062525291977776713076159922),
            KSF(   -0.37265109052391150467568657507818254330653867),
            KSF(    0.29997903151477853923521292469052989399797325),
            KSF(   -0.23427779429713451853168149503953747830957326),
            KSF(    0.17722470347887992807724228254371459100294244),
            KSF(   -0.12966168625511452863736052933320891512974752),
            KSF(    0.09161536920454525520082462562382336716813157),
            KSF(   -0.06243038731787003864341087527912749847428471),
            KSF(    0.04097476136465218537517519580197665436602286),
            KSF(   -0.02586809749183906069012498766006032892319955),
            KSF(    0.01568851897728729545752589240747978130938163),
            KSF(   -0.00912874653353444898472732498886504415678407),
            KSF(    0.00508966259664760086286426087076444821469081),
            KSF(   -0.00271544504042932066820163575027091393773605),
            KSF(    0.00138444428921604237725440651605484169156444),
            KSF(   -0.00067356167531100103921869037760848932355671),
            KSF(    0.00031224975463384082939988824074361769446545),
            KSF(   -0.00013771110245834068053021620895100658661382),
            KSF(    0.00005768379157591993584276198237942931784642),
            KSF(   -0.00002290768364059413505817229206993968615271),
            KSF(    0.00000860825856700506700298277831183813416099),
            KSF(   -0.00000305456780671681571650731559324445357327),
            KSF(    0.00000102116411774357391402149089276418930166),
            KSF(   -0.00000032082395562973770124565022483974165535),
            KSF(    0.00000009446345676400590566623318482444715586),
            KSF(   -0.00000002598678162240081858422722083488372693),
            KSF(    0.00000000665638686888521587670262058366321731),
            KSF(   -0.00000000158137839500352173239308236429775066),
            KSF(    0.00000000034691687432959612972319468931696147),
            KSF(   -0.00000000006992033177131011224247232839003291),
            KSF(    0.00000000001287098048395716187413597395324471),
            KSF(   -0.00000000000214903686280732662828947056867143),
            KSF(    0.00000000000032278820644623612607613858740949),
            KSF(   -0.00000000000004318081199855161024779972424506),
            KSF(    0.00000000000000508149750657549676587228310083),
            KSF(   -0.00000000000000051785137614975979629834293008),
            KSF(    0.00000000000000004477143208928946063816162226),
            KSF(   -0.00000000000000000319278806932655863379693521),
            KSF(    0.00000000000000000018030566849463306614839286),
            KSF(   -0.00000000000000000000755990198974588789197610),
            KSF(    0.00000000000000000000020920123019387786812519),
            KSF(   -0.00000000000000000000000286577027662846394692),
        };


        /* NOTE: this table is useful for abs(imag(x)) <= 256 */
        static const int n_8 = 256;
        static const ks_cfloat d_8[] = {
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    1.00000000000000000000000000000000000000000000),
            KSF(   -1.00000000000000000000000000000000000000000000),
            KSF(    0.99999999999999999999999999999999999999999999),
            KSF(   -0.99999999999999999999999999999999999999999995),
            KSF(    0.99999999999999999999999999999999999999999959),
            KSF(   -0.99999999999999999999999999999999999999999681),
            KSF(    0.99999999999999999999999999999999999999997591),
            KSF(   -0.99999999999999999999999999999999999999982253),
            KSF(    0.99999999999999999999999999999999999999872550),
            KSF(   -0.99999999999999999999999999999999999999107453),
            KSF(    0.99999999999999999999999999999999999993903649),
            KSF(   -0.99999999999999999999999999999999999959379793),
            KSF(    0.99999999999999999999999999999999999735923359),
            KSF(   -0.99999999999999999999999999999999998324619563),
            KSF(    0.99999999999999999999999999999999989625427936),
            KSF(   -0.99999999999999999999999999999999937284370046),
            KSF(    0.99999999999999999999999999999999629827901578),
            KSF(   -0.99999999999999999999999999999997866339700344),
            KSF(    0.99999999999999999999999999999987988147248504),
            KSF(   -0.99999999999999999999999999999933942011983700),
            KSF(    0.99999999999999999999999999999645074737292506),
            KSF(   -0.99999999999999999999999999998136589718275228),
            KSF(    0.99999999999999999999999999990439027785948768),
            KSF(   -0.99999999999999999999999999952051186461099927),
            KSF(    0.99999999999999999999999999764931485266533608),
            KSF(   -0.99999999999999999999999998873298843007312764),
            KSF(    0.99999999999999999999999994719488789443619588),
            KSF(   -0.99999999999999999999999975798078802923239191),
            KSF(    0.99999999999999999999999891511797953877908331),
            KSF(   -0.99999999999999999999999524309343634886729832),
            KSF(    0.99999999999999999999997959552888911543074821),
            KSF(   -0.99999999999999999999991436872531098412143347),
            KSF(    0.99999999999999999999964836495806411382244506),
            KSF(   -0.99999999999999999999858697608917096284398666),
            KSF(    0.99999999999999999999444290136752074483875177),
            KSF(   -0.99999999999999999997860904263133767351248838),
            KSF(    0.99999999999999999991939966117480080376472220),
            KSF(   -0.99999999999999999970269118365575808338591797),
            KSF(    0.99999999999999999892630359421776507366059944),
            KSF(   -0.99999999999999999620339589053811001757103541),
            KSF(    0.99999999999999998685425013200231806724530099),
            KSF(   -0.99999999999999995542548418135656171297955686),
            KSF(    0.99999999999999985197571238599280041289640651),
            KSF(   -0.99999999999999951854338767881553025629105251),
            KSF(    0.99999999999999846612191430501392835998233035),
            KSF(   -0.99999999999999521298629028192174011992188142),
            KSF(    0.99999999999998536447699027524798127331240836),
            KSF(   -0.99999999999995616205614667569267135695196919),
            KSF(    0.99999999999987134754072358093431802398828203),
            KSF(   -0.99999999999963005370479496599662841549353848),
            KSF(    0.99999999999895759205523587234466765901622430),
            KSF(   -0.99999999999712167349183186532051467756429979),
            KSF(    0.99999999999221121480195587873184858647311346),
            KSF(   -0.99999999997934382532299129429628572737254096),
            KSF(    0.99999999994630882078428424772417185571489034),
            KSF(   -0.99999999986321122374138274932828743964174335),
            KSF(    0.99999999965840356519564496932932425194778470),
            KSF(   -0.99999999916379703266007938390939351812093873),
            KSF(    0.99999999799338019184435160458619337148460044),
            KSF(   -0.99999999527945232532350300051307447312833302),
            KSF(    0.99999998911290791951006832082570855940437995),
            KSF(   -0.99999997538264401174085432073859452493090682),
            KSF(    0.99999994542443607476879897705258453304620478),
            KSF(   -0.99999988136870451164515839014728694867991669),
            KSF(    0.99999974715109552957123445455713015454877470),
            KSF(   -0.99999947155486283530785926327776661822600073),
            KSF(    0.99999891699161439000747987586005694987737534),
            KSF(   -0.99999782342943075656585316436888083755110489),
            KSF(    0.99999571018451536057062937206252111279485384),
            KSF(   -0.99999170826560581041549742223978906665241384),
            KSF(    0.99998428156747311865418233297131355892715879),
            KSF(   -0.99997077552846459505764866243279635143554743),
            KSF(    0.99994670645171379876545466358444767340351933),
            KSF(   -0.99990467413979320993824710405472884198899109),
            KSF(    0.99983274721671069848609882292528047811528009),
            KSF(   -0.99971213960876623370807195401608967647929817),
            KSF(    0.99951397672887773335126325041592554923435574),
            KSF(   -0.99919495348173624429400702668059793101394012),
            KSF(    0.99869172931192117211532954680341872758671321),
            KSF(   -0.99791400595340509376825174891347740802750445),
            KSF(    0.99673640740401800346058493075768390673414914),
            KSF(   -0.99498953804290360790159126888029124027568696),
            KSF(    0.99245092916714674015536519211530429189473314),
            KSF(   -0.98883697146394160541412265343246020290366541),
            KSF(    0.98379732040408312919850212056461031780422977),
            KSF(   -0.97691357627959606992356486576534619250252450),
            KSF(    0.96770418342051418220062375590650125557170367),
            KSF(   -0.95563736108075812388171593046962445235632303),
            KSF(    0.94015338551204459772028553499752589955782574),
            KSF(   -0.92069664736879928399045191977858598838066375),
            KSF(    0.89675664089686597794176010798214473554402755),
            KSF(   -0.86791552126282237505786740402953835464488222),
            KSF(    0.83389830483268588269684956608722640642944389),
            KSF(   -0.79462046442903094301123388157323805459722594),
            KSF(    0.75022689131545940716027139898880891218546212),
            KSF(   -0.70111622129401185417586771152804896398519139),
            KSF(    0.64794550790823383724478694124888404712851595),
            KSF(   -0.59161215925369938881041152114371556472762155),
            KSF(    0.53321273142381293414283477411732688264721432),
            KSF(   -0.47398120939105807695164323773231853048191614),
            KSF(    0.41521230754673450826453329903408801123698993),
            KSF(   -0.35817757001912868422720693229744462206814350),
            KSF(    0.30404321883007573306845210245473609545121359),
            KSF(   -0.25379854745618874873652935992439093693002881),
            KSF(    0.20820219625809654323507055949058410104744421),
            KSF(   -0.16775113158321094049919192591050686911651368),
            KSF(    0.13267403388343141656082023250221691880636464),
            KSF(   -0.10294762983723705599362114846693166261324941),
            KSF(    0.07833180601728746953865543008026231353957269),
            KSF(   -0.05841751625999305206772962484383574363307839),
            KSF(    0.04268074273686997494583696625091869650967784),
            KSF(   -0.03053607493645318287965282501745883310554243),
            KSF(    0.02138462662748411611772121247927510002493883),
            KSF(   -0.01465269312751082595470250600467682297138032),
            KSF(    0.00981939748270250647887371447529968428928710),
            KSF(   -0.00643326250931798227524739018920914035267124),
            KSF(    0.00411894900890503819161816709256313682898036),
            KSF(   -0.00257621004727386865096465513527334872508992),
            KSF(    0.00157342972221360844953987236303498645756113),
            KSF(   -0.00093802821650676102820308366632207175765380),
            KSF(    0.00054565377614753419147605657023875821854930),
            KSF(   -0.00030958481892648211762255455381030816809299),
            KSF(    0.00017124957003896143061012155401132699601970),
            KSF(   -0.00009231870586364996699661097245746857545812),
            KSF(    0.00004848189893700295825597725212314865185659),
            KSF(   -0.00002479214820287782457152768574252869805572),
            KSF(    0.00001233966036911746989360582956835991001400),
            KSF(   -0.00000597517930630814332110286166797582117563),
            KSF(    0.00000281355335727534795249160212796231369609),
            KSF(   -0.00000128767581804991985821030484436245449533),
            KSF(    0.00000057251643344707469559552580839182598594),
            KSF(   -0.00000024715742659279604133286842294676258322),
            KSF(    0.00000010354484826474689119793416103972601769),
            KSF(   -0.00000004207333970084619788924218228882014024),
            KSF(    0.00000001657114192913771871754520708776438275),
            KSF(   -0.00000000632260277076656288136553910219733469),
            KSF(    0.00000000233536662493775951302205422758475775),
            KSF(   -0.00000000083451299529880553518221953982111950),
            KSF(    0.00000000028828183893300275695618734604505940),
            KSF(   -0.00000000009620055317799518659098921196996134),
            KSF(    0.00000000003098596253516576013242490130386893),
            KSF(   -0.00000000000962520217587188521320109565172334),
            KSF(    0.00000000000288084417412695310933063592130896),
            KSF(   -0.00000000000082999856349983789793840109905378),
            KSF(    0.00000000000022995227697704852295910997736457),
            KSF(   -0.00000000000006119637062352605673393372468540),
            KSF(    0.00000000000001562544368514569844559665564208),
            KSF(   -0.00000000000000382306435786543671351933421460),
            KSF(    0.00000000000000089510836107212370070219820829),
            KSF(   -0.00000000000000020025805493394670490053739985),
            KSF(    0.00000000000000004274329964176853919179344471),
            KSF(   -0.00000000000000000868888432067405994898926911),
            KSF(    0.00000000000000000167905600909534130399542657),
            KSF(   -0.00000000000000000030780982302595715495884130),
            KSF(    0.00000000000000000005341205008412009783702636),
            KSF(   -0.00000000000000000000875100181965008165378698),
            KSF(    0.00000000000000000000135002810725219325770731),
            KSF(   -0.00000000000000000000019550659026330658598919),
            KSF(    0.00000000000000000000002648608634087302053150),
            KSF(   -0.00000000000000000000000334365797796323239178),
            KSF(    0.00000000000000000000000039160549185724073184),
            KSF(   -0.00000000000000000000000004233376077869550503),
            KSF(    0.00000000000000000000000000419921808662759366),
            KSF(   -0.00000000000000000000000000037955686794043589),
            KSF(    0.00000000000000000000000000003100400624810521),
            KSF(   -0.00000000000000000000000000000226587704336024),
            KSF(    0.00000000000000000000000000000014633466946189),
            KSF(   -0.00000000000000000000000000000000822092916375),
            KSF(    0.00000000000000000000000000000000039356127671),
            KSF(   -0.00000000000000000000000000000000001560978678),
            KSF(    0.00000000000000000000000000000000000049244280),
            KSF(   -0.00000000000000000000000000000000000001158430),
            KSF(    0.00000000000000000000000000000000000000018063),
            KSF(   -0.00000000000000000000000000000000000000000140),
        };


        /* discriminate between tables with 'abs(im(x)) */
        ks_cfloat a_xi = fabs(x.im);
        ks_ccomplex neg_x = KS_CC_NEG(x), tmp;

        /* Sum correct table */
        ks_cfloat sumr = 0.0, sumi = 0.0;
        int i;
        if (0) { 

        } else if (a_xi <= 1) {
            for (i = 0; i < n_0; ++i) {
                tmp = ksm_cpow(KS_CC_MAKE(i+1, 0), neg_x);
                sumr += d_0[i] * tmp.re;
                sumi += d_0[i] * tmp.im;
            }
        } else if (a_xi <= 2) {
            for (i = 0; i < n_1; ++i) {
                tmp = ksm_cpow(KS_CC_MAKE(i+1, 0), neg_x);
                sumr += d_1[i] * tmp.re;
                sumi += d_1[i] * tmp.im;
            }
        } else if (a_xi <= 4) {
            for (i = 0; i < n_2; ++i) {
                tmp = ksm_cpow(KS_CC_MAKE(i+1, 0), neg_x);
                sumr += d_2[i] * tmp.re;
                sumi += d_2[i] * tmp.im;
            }
        } else if (a_xi <= 8) {
            for (i = 0; i < n_3; ++i) {
                tmp = ksm_cpow(KS_CC_MAKE(i+1, 0), neg_x);
                sumr += d_3[i] * tmp.re;
                sumi += d_3[i] * tmp.im;
            }
        } else if (a_xi <= 16) {
            for (i = 0; i < n_4; ++i) {
                tmp = ksm_cpow(KS_CC_MAKE(i+1, 0), neg_x);
                sumr += d_4[i] * tmp.re;
                sumi += d_4[i] * tmp.im;
            }
        } else if (a_xi <= 32) {
            for (i = 0; i < n_5; ++i) {
                tmp = ksm_cpow(KS_CC_MAKE(i+1, 0), neg_x);
                sumr += d_5[i] * tmp.re;
                sumi += d_5[i] * tmp.im;
            }
        } else if (a_xi <= 64) {
            for (i = 0; i < n_6; ++i) {
                tmp = ksm_cpow(KS_CC_MAKE(i+1, 0), neg_x);
                sumr += d_6[i] * tmp.re;
                sumi += d_6[i] * tmp.im;
            }
        } else if (a_xi <= 128) {
            for (i = 0; i < n_7; ++i) {
                tmp = ksm_cpow(KS_CC_MAKE(i+1, 0), neg_x);
                sumr += d_7[i] * tmp.re;
                sumi += d_7[i] * tmp.im;
            }
        } else {
            for (i = 0; i < n_8; ++i) {
                tmp = ksm_cpow(KS_CC_MAKE(i+1, 0), neg_x);
                sumr += d_8[i] * tmp.re;
                sumi += d_8[i] * tmp.im;
            }

        }

        /* Transform by normalization factor */
        tmp = ksm_cpow(KS_CC_MAKE(2, 0), KS_CC_MAKE(1-x.re, x.im));
        return ksm_cdiv(KS_CC_MAKE(sumr, sumi), KS_CC_MAKE(1-tmp.re, tmp.im));
    }
}

